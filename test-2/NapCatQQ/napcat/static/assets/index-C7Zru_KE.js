import{h as f,R as de,m as Qe,_ as Ve,j as e}from"./codemirror-core-vkcnXJgD.js";import{b as q,a as K,c as Ie}from"./chunk-5PILOUBS-0YCBWX_5.js";import{t as Me,a as P}from"./chunk-ML27DD5T-B8jMVnkz.js";import{i as ge,c as W,J as v,x as ze,u as Y,I as J,S as Xe}from"./react-dom-Cz0lLOn1.js";import{g as qe,f as pe,b as S,k as A,W as F,P as B,h as se,i as Ke,l as Ye,j as Re,n as Ge,p as Ee}from"./index-CRxYmROf.js";import{u as Je,i as z}from"./chunk-2QAN2V2R-DUfyhebH.js";import{u as _,C,a as Ze}from"./react-hook-form-CmdhCKo7.js";import{a as Pe,f as xe}from"./index-CT80i5B1.js";import{Q as be}from"./qq_manager-OcYl2PUj.js";import{P as er,w as rr,s as tr}from"./process_utils-Du-kJnjM.js";import{S as G}from"./switch_card-CesiqZwN.js";import{u as sr}from"./use-config-3QlPJxkM.js";import{s as Fe,l as D}from"./chunk-KVDW62ZT-7LdzXPwy.js";import{C as ar}from"./chunk-M3MASYO7-Cm5fw87L.js";import{c as Te}from"./chunk-NAV3ZXLI-Cx7sjRMR.js";import{G as ue}from"./iconBase-DqQMrcxU.js";import{b as or}from"./index-BCo31U5i.js";import{b as nr,a as ir}from"./index-Ct0bcwxX.js";import{p as lr,a as dr,b as ur}from"./chunk-2QQAR2RD-5fklPBbg.js";import{F as X}from"./file_manager-TLJ_vqgs.js";import{i as cr}from"./chunk-MLPFQTYO-BGSgsnSp.js";import{L as hr,a as fr}from"./index-CT9CJoSJ.js";import"./chunk-UX7UMZL5-D0R1-FPm.js";import"./index-CokAva9Y.js";import"./Item-CdZrGEbe.js";import"./chunk-SLABUSGS-Dy5CjS7O.js";import"./chunk-J6JGI6RM-CcOOoqKk.js";import"./chunk-EN4B57RQ-DpwResUR.js";import"./chunk-AXSF7SRE-CGODruUG.js";import"./chunk-WQVQ7P2I-BFZSGHT9.js";import"./chunk-FGM523TA-BJSiCD_V.js";var mr=f.useLayoutEffect,gr=function(s){var t=de.useRef(s);return mr(function(){t.current=s}),t},ve=function(s,t){if(typeof s=="function"){s(t);return}s.current=t},pr=function(s,t){var a=de.useRef();return de.useCallback(function(l){s.current=l,a.current&&ve(a.current,null),a.current=t,t&&ve(t,l)},[t])},we={"min-height":"0","max-height":"none",height:"0",visibility:"hidden",overflow:"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0",display:"block"},xr=function(s){Object.keys(we).forEach(function(t){s.style.setProperty(t,we[t],"important")})},ye=xr,I=null,je=function(s,t){var a=s.scrollHeight;return t.sizingStyle.boxSizing==="border-box"?a+t.borderSize:a-t.paddingSize};function br(r,s,t,a){t===void 0&&(t=1),a===void 0&&(a=1/0),I||(I=document.createElement("textarea"),I.setAttribute("tabindex","-1"),I.setAttribute("aria-hidden","true"),ye(I)),I.parentNode===null&&document.body.appendChild(I);var l=r.paddingSize,i=r.borderSize,o=r.sizingStyle,c=o.boxSizing;Object.keys(o).forEach(function(p){var w=p;I.style[w]=o[w]}),ye(I),I.value=s;var n=je(I,r);I.value=s,n=je(I,r),I.value="x";var d=I.scrollHeight-l,u=d*t;c==="border-box"&&(u=u+l+i),n=Math.max(u,n);var b=d*a;return c==="border-box"&&(b=b+l+i),n=Math.min(b,n),[n,d]}var ke=function(){},vr=function(s,t){return s.reduce(function(a,l){return a[l]=t[l],a},{})},wr=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth","boxSizing","fontFamily","fontSize","fontStyle","fontWeight","letterSpacing","lineHeight","paddingBottom","paddingLeft","paddingRight","paddingTop","tabSize","textIndent","textRendering","textTransform","width","wordBreak","wordSpacing","scrollbarGutter"],yr=!!document.documentElement.currentStyle,jr=function(s){var t=window.getComputedStyle(s);if(t===null)return null;var a=vr(wr,t),l=a.boxSizing;if(l==="")return null;yr&&l==="border-box"&&(a.width=parseFloat(a.width)+parseFloat(a.borderRightWidth)+parseFloat(a.borderLeftWidth)+parseFloat(a.paddingRight)+parseFloat(a.paddingLeft)+"px");var i=parseFloat(a.paddingBottom)+parseFloat(a.paddingTop),o=parseFloat(a.borderBottomWidth)+parseFloat(a.borderTopWidth);return{sizingStyle:a,paddingSize:i,borderSize:o}},kr=jr;function ce(r,s,t){var a=gr(t);f.useLayoutEffect(function(){var l=function(o){return a.current(o)};if(r)return r.addEventListener(s,l),function(){return r.removeEventListener(s,l)}},[])}var Nr=function(s,t){ce(document.body,"reset",function(a){s.current.form===a.target&&t(a)})},Cr=function(s){ce(window,"resize",s)},Sr=function(s){ce(document.fonts,"loadingdone",s)},Lr=["cacheMeasurements","maxRows","minRows","onChange","onHeightChange"],Ir=function(s,t){var a=s.cacheMeasurements,l=s.maxRows,i=s.minRows,o=s.onChange,c=o===void 0?ke:o,n=s.onHeightChange,d=n===void 0?ke:n,u=Qe(s,Lr),b=u.value!==void 0,p=f.useRef(null),w=pr(p,t),y=f.useRef(0),h=f.useRef(),m=function(){var N=p.current,L=a&&h.current?h.current:kr(N);if(L){h.current=L;var M=br(L,N.value||N.placeholder||"x",i,l),R=M[0],E=M[1];y.current!==R&&(y.current=R,N.style.setProperty("height",R+"px","important"),d(R,{rowHeight:E}))}},g=function(N){b||m(),c(N)};return f.useLayoutEffect(m),Nr(p,function(){if(!b){var k=p.current.value;requestAnimationFrame(function(){var N=p.current;N&&k!==N.value&&m()})}}),Cr(m),Sr(m),f.createElement("textarea",Ve({},u,{onChange:g,ref:w}))},Mr=f.forwardRef(Ir),We=qe(({style:r,minRows:s=3,maxRows:t=8,cacheMeasurements:a=!1,disableAutosize:l=!1,onHeightChange:i,...o},c)=>{const{Component:n,label:d,description:u,startContent:b,endContent:p,hasHelper:w,shouldLabelBeOutside:y,shouldLabelBeInside:h,isInvalid:m,errorMessage:g,getBaseProps:k,getLabelProps:N,getInputProps:L,getInnerWrapperProps:M,getInputWrapperProps:R,getHelperWrapperProps:E,getDescriptionProps:x,getErrorMessageProps:j,isClearable:T,getClearButtonProps:V}=Je({...o,ref:c,isMultiline:!0}),[O,Z]=f.useState(s>1),[ee,H]=f.useState(!1),he=d?e.jsx("label",{...N(),children:d}):null,$=L(),_e=(re,te)=>{if(s===1&&Z(re>=te.rowHeight*2),t>s){const Be=re>=t*te.rowHeight;H(Be)}i==null||i(re,te)},fe=l?e.jsx("textarea",{...$,style:ge($.style,r??{})}):e.jsx(Mr,{...$,cacheMeasurements:a,"data-hide-scroll":pe(!ee),maxRows:t,minRows:s,style:ge($.style,r??{}),onHeightChange:_e}),Oe=f.useMemo(()=>T?e.jsx("button",{...V(),children:e.jsx(ar,{})}):null,[T,V]),$e=f.useMemo(()=>b||p?e.jsxs("div",{...M(),children:[b,fe,p]}):e.jsx("div",{...M(),children:fe}),[b,$,p,M]),me=m&&g,Ae=me||u;return e.jsxs(n,{...k(),children:[y?he:null,e.jsxs("div",{...R(),"data-has-multiple-rows":pe(O),children:[h?he:null,$e,Oe]}),w&&Ae?e.jsx("div",{...E(),children:me?e.jsx("div",{...j(),children:g}):e.jsx("div",{...x(),children:u})}):null]})});We.displayName="HeroUI.Textarea";var Ne=We;const Q=({onSubmit:r,reset:s,isSubmitting:t,refresh:a,className:l})=>e.jsx("div",{className:W("w-full flex flex-col justify-center gap-3",l),children:e.jsxs("div",{className:"flex items-center justify-center gap-2 mt-5",children:[e.jsx(S,{radius:"full",variant:"flat",className:"font-medium bg-default-100 text-default-600 dark:bg-default-50/50",onPress:()=>{s(),v.success("重置成功")},children:"取消更改"}),e.jsx(S,{color:"primary",radius:"full",className:"font-medium shadow-md shadow-primary/20",isLoading:t,onPress:()=>r(),children:"保存"}),a&&e.jsx(S,{isIconOnly:!0,radius:"full",variant:"flat",className:"text-default-500 bg-default-100 dark:bg-default-50/50",onPress:()=>a(),children:e.jsx(Pe,{size:20})})]})}),zr=()=>{const{control:r,handleSubmit:s,formState:{isSubmitting:t,errors:a},reset:l,watch:i}=_({defaultValues:{oldToken:"",newToken:""}}),o=ze(),[,c]=Y(A.token,""),n=i("oldToken"),d=s(async u=>{try{await F.changePassword(u.oldToken,u.newToken),v.success("修改成功"),c(""),localStorage.removeItem(A.token),o("/web_login")}catch(b){const p=b.message;v.error(`修改失败: ${p}`)}});return e.jsxs(e.Fragment,{children:[e.jsx("title",{children:"修改密码 - NapCat WebUI"}),e.jsx(C,{control:r,name:"oldToken",rules:{required:"旧密码不能为空",validate:u=>!u||u.trim().length===0?"旧密码不能为空":!0},render:({field:u})=>{var b;return e.jsx(z,{...u,label:"旧密码",placeholder:"请输入旧密码",type:"password",isRequired:!0,isInvalid:!!a.oldToken,errorMessage:(b=a.oldToken)==null?void 0:b.message})}}),e.jsx(C,{control:r,name:"newToken",rules:{required:"新密码不能为空",minLength:{value:6,message:"新密码至少需要6个字符"},validate:u=>!u||u.trim().length===0?"新密码不能为空":u.trim().length!==u.length?"新密码不能包含前后空格":u===n?"新密码不能与旧密码相同":/[a-zA-Z]/.test(u)?/[0-9]/.test(u)?!0:"新密码必须包含数字":"新密码必须包含字母"},render:({field:u})=>{var b;return e.jsx(z,{...u,label:"新密码",placeholder:"至少6位，包含字母和数字",type:"password",isRequired:!0,isInvalid:!!a.newToken,errorMessage:(b=a.newToken)==null?void 0:b.message})}}),e.jsx(Q,{onSubmit:d,reset:l,isSubmitting:t})]})},Rr=()=>{const[r,s]=f.useState(!1),{data:t,loading:a,error:l,refreshAsync:i}=J(be.getQuickLoginQQ),{control:o,handleSubmit:c,formState:{isSubmitting:n},setValue:d}=_({defaultValues:{quickLoginQQ:""}}),u=()=>{d("quickLoginQQ",t??"")},b=c(async y=>{try{await be.setQuickLoginQQ(y.quickLoginQQ),v.success("保存成功")}catch(h){const m=h.message;v.error(`保存失败: ${m}`)}}),p=async()=>{try{await i(),v.success("刷新成功")}catch(y){const h=y.message;v.error(`刷新失败: ${h}`)}},w=async()=>{s(!0);try{const y=await er.restartProcess();v.success(y.message||"进程重启请求已发送"),await rr(3e4,()=>{s(!1),v.success("进程重启完成")},()=>{s(!1),v.error("后端在 30 秒内未响应，请检查 NapCat 运行日志")})||s(!1)}catch(y){const h=y.message;v.error(`进程重启失败: ${h}`),s(!1)}};return f.useEffect(()=>{u()},[t]),a?e.jsx(B,{loading:!0}):e.jsxs(e.Fragment,{children:[e.jsx("title",{children:"OneBot配置 - NapCat WebUI"}),e.jsx("div",{className:"flex-shrink-0 w-full",children:"快速登录QQ"}),e.jsx(C,{control:o,name:"quickLoginQQ",render:({field:y})=>e.jsx(z,{...y,label:"快速登录QQ",placeholder:"请输入QQ号",isDisabled:!!l,errorMessage:l?"获取快速登录QQ失败":void 0})}),e.jsx(Q,{onSubmit:b,reset:u,isSubmitting:n||a,refresh:p}),e.jsxs("div",{className:"flex-shrink-0 w-full mt-6 pt-6 border-t border-divider",children:[e.jsx("div",{className:"mb-3 text-sm text-default-600",children:"进程管理"}),e.jsx(S,{color:"warning",variant:"flat",onPress:w,isLoading:r,isDisabled:r,fullWidth:!0,children:r?"正在重启进程...":"重启进程"}),e.jsx("div",{className:"mt-2 text-xs text-default-500",children:"重启进程将关闭当前 Worker 进程，等待 3 秒后启动新进程"})]})]})},Er=()=>{const{config:r,saveConfigWithoutNetwork:s,refreshConfig:t}=sr(),[a,l]=f.useState(!1),{control:i,handleSubmit:o,formState:{isSubmitting:c},setValue:n}=_({defaultValues:{musicSignUrl:"",enableLocalFile2Url:!1,parseMultMsg:!1,imageDownloadProxy:""}}),d=()=>{n("musicSignUrl",r.musicSignUrl),n("enableLocalFile2Url",r.enableLocalFile2Url),n("parseMultMsg",r.parseMultMsg),n("imageDownloadProxy",r.imageDownloadProxy)},u=o(async p=>{try{await s(p),v.success("保存成功")}catch(w){const y=w.message;v.error(`保存失败: ${y}`)}}),b=async(p=!0)=>{try{l(!0),await t(),p&&v.success("刷新成功")}catch(w){const y=w.message;v.error(`刷新失败: ${y}`)}finally{l(!1)}};return f.useEffect(()=>{d()},[r]),f.useEffect(()=>{b(!1)},[]),a?e.jsx(B,{loading:!0}):e.jsxs(e.Fragment,{children:[e.jsx("title",{children:"OneBot配置 - NapCat WebUI"}),e.jsx(C,{control:i,name:"musicSignUrl",render:({field:p})=>e.jsx(z,{...p,label:"音乐签名地址",placeholder:"请输入音乐签名地址",classNames:{inputWrapper:"bg-default-100/50 dark:bg-white/5 backdrop-blur-md border border-transparent hover:bg-default-200/50 dark:hover:bg-white/10 transition-all shadow-sm data-[hover=true]:border-default-300",input:"bg-transparent text-default-700 placeholder:text-default-400"}})}),e.jsx(C,{control:i,name:"enableLocalFile2Url",render:({field:p})=>e.jsx(G,{...p,description:"启用本地文件到URL",label:"启用本地文件到URL"})}),e.jsx(C,{control:i,name:"parseMultMsg",render:({field:p})=>e.jsx(G,{...p,description:"启用上报解析合并消息",label:"启用上报解析合并消息"})}),e.jsx(C,{control:i,name:"imageDownloadProxy",render:({field:p})=>e.jsx(z,{...p,label:"图片下载代理",placeholder:"请输入代理地址，如 http://127.0.0.1:7890",classNames:{inputWrapper:"bg-default-100/50 dark:bg-white/5 backdrop-blur-md border border-transparent hover:bg-default-200/50 dark:hover:bg-white/10 transition-all shadow-sm data-[hover=true]:border-default-300",input:"bg-transparent text-default-700 placeholder:text-default-400"}})}),e.jsx(Q,{onSubmit:u,reset:d,isSubmitting:c,refresh:b})]})},Pr=()=>{const{data:r,loading:s,error:t,refreshAsync:a}=J(F.getWebUIConfig),[l,i]=f.useState(""),{control:o,handleSubmit:c,formState:{isSubmitting:n},setValue:d,watch:u}=_({defaultValues:{host:"0.0.0.0",port:6099,loginRate:10,disableWebUI:!1,accessControlMode:"none",ipWhitelist:[],ipBlacklist:[],enableXForwardedFor:!1}}),b=u("accessControlMode"),p=()=>{r&&(d("host",r.host),d("port",r.port),d("loginRate",r.loginRate),d("disableWebUI",r.disableWebUI),d("accessControlMode",r.accessControlMode||"none"),d("ipWhitelist",r.ipWhitelist||[]),d("ipBlacklist",r.ipBlacklist||[]),d("enableXForwardedFor",r.enableXForwardedFor||!1),r.accessControlMode==="whitelist"?i((r.ipWhitelist||[]).join(`
`)):r.accessControlMode==="blacklist"&&i((r.ipBlacklist||[]).join(`
`)))},w=c(async h=>{try{const m=l.split(`
`).map(k=>k.trim()).filter(k=>k.length>0),g={...h,ipWhitelist:h.accessControlMode==="whitelist"?m:[],ipBlacklist:h.accessControlMode==="blacklist"?m:[]};await F.updateWebUIConfig(g),v.success("保存成功")}catch(m){const g=m.message;v.error(`保存失败: ${g}`)}}),y=async()=>{try{await a(),v.success("刷新成功")}catch(h){const m=h.message;v.error(`刷新失败: ${m}`)}};return f.useEffect(()=>{p()},[r]),f.useEffect(()=>{(async()=>{if(r)if(b==="whitelist"){const m=r.ipWhitelist||[];if(m.length===0)try{const g=await F.getClientIP();g!=null&&g.ip?i(g.ip):i("")}catch(g){console.error("获取客户端IP失败:",g),i("")}else i(m.join(`
`))}else i(b==="blacklist"?(r.ipBlacklist||[]).join(`
`):"")})()},[b,r]),s?e.jsx(B,{loading:!0}):e.jsxs(e.Fragment,{children:[e.jsx("title",{children:"服务器配置 - NapCat WebUI"}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("div",{className:"flex-shrink-0 w-full font-bold text-default-600 dark:text-default-400 px-1",children:"服务器配置"}),e.jsx(C,{control:o,name:"host",render:({field:h})=>e.jsx(z,{...h,label:"监听地址",placeholder:"请输入监听地址",description:"服务器监听的IP地址，0.0.0.0表示监听所有网卡",isDisabled:!!t,errorMessage:t?"获取配置失败":void 0,classNames:{inputWrapper:"bg-default-100/50 dark:bg-white/5 backdrop-blur-md border border-transparent hover:bg-default-200/50 dark:hover:bg-white/10 transition-all shadow-sm data-[hover=true]:border-default-300",input:"bg-transparent text-default-700 placeholder:text-default-400"}})}),e.jsx(C,{control:o,name:"port",render:({field:h})=>{var m;return e.jsx(z,{...h,type:"number",value:((m=h.value)==null?void 0:m.toString())||"",label:"监听端口",placeholder:"请输入监听端口",description:"服务器监听的端口号，范围1-65535",isDisabled:!!t,errorMessage:t?"获取配置失败":void 0,onChange:g=>h.onChange(parseInt(g.target.value)||0),classNames:{inputWrapper:"bg-default-100/50 dark:bg-white/5 backdrop-blur-md border border-transparent hover:bg-default-200/50 dark:hover:bg-white/10 transition-all shadow-sm data-[hover=true]:border-default-300",input:"bg-transparent text-gray-800 dark:text-white placeholder:text-gray-400 dark:placeholder:text-gray-500"}})}}),e.jsx(C,{control:o,name:"loginRate",render:({field:h})=>{var m;return e.jsx(z,{...h,type:"number",value:((m=h.value)==null?void 0:m.toString())||"",label:"登录速率限制",placeholder:"请输入登录速率限制",description:"每小时允许的登录尝试次数",isDisabled:!!t,errorMessage:t?"获取配置失败":void 0,onChange:g=>h.onChange(parseInt(g.target.value)||0),classNames:{inputWrapper:"bg-default-100/50 dark:bg-white/5 backdrop-blur-md border border-transparent hover:bg-default-200/50 dark:hover:bg-white/10 transition-all shadow-sm data-[hover=true]:border-default-300",input:"bg-transparent text-gray-800 dark:text-white placeholder:text-gray-400 dark:placeholder:text-gray-500"}})}})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("div",{className:"flex-shrink-0 w-full font-bold text-default-600 dark:text-default-400 px-1",children:"安全配置"}),e.jsx(C,{control:o,name:"disableWebUI",render:({field:h})=>e.jsx(G,{value:h.value,onValueChange:m=>h.onChange(m),disabled:!!t,label:"禁用WebUI",description:"启用后将完全禁用WebUI服务，需要重启生效"})}),e.jsxs("div",{className:"flex flex-col gap-3 mt-2",children:[e.jsx("div",{className:"text-sm font-medium text-default-700 dark:text-default-300 px-1",children:"网络访问控制"}),e.jsx(C,{control:o,name:"accessControlMode",render:({field:h})=>e.jsxs(Fe,{...h,label:"访问控制模式",placeholder:"选择访问控制模式",description:"选择如何控制网络访问",selectedKeys:[h.value],onSelectionChange:m=>{const g=Array.from(m)[0];h.onChange(g)},isDisabled:!!t,classNames:{trigger:"bg-default-100/50 dark:bg-white/5 backdrop-blur-md border border-transparent hover:bg-default-200/50 dark:hover:bg-white/10 transition-all shadow-sm data-[hover=true]:border-default-300"},children:[e.jsx(D,{value:"none",children:"不限制"},"none"),e.jsx(D,{value:"whitelist",children:"白名单模式"},"whitelist"),e.jsx(D,{value:"blacklist",children:"黑名单模式"},"blacklist")]})}),b!=="none"&&e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{className:"text-sm font-medium text-default-700 dark:text-default-300",children:b==="whitelist"?"IP白名单":"IP黑名单"}),e.jsx("textarea",{value:l,onChange:h=>i(h.target.value),placeholder:`每行一个IP地址或规则
支持格式：
IPv4:
- 精确IP: 192.168.1.100
- 通配符: 192.168.1.*
- CIDR: 192.168.1.0/24
IPv6:
- 精确IP: 2001:db8::1
- CIDR: 2001:db8::/32`,disabled:!!t,rows:10,className:"w-full px-3 py-2 bg-default-100/50 dark:bg-white/5 backdrop-blur-md border border-transparent hover:bg-default-200/50 dark:hover:bg-white/10 transition-all shadow-sm hover:border-default-300 rounded-lg text-default-700 dark:text-default-300 placeholder:text-default-400 font-mono text-sm resize-y focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent disabled:opacity-50 disabled:cursor-not-allowed"}),e.jsx("p",{className:"text-xs text-default-500",children:b==="whitelist"?"只有列表中的IP可以访问":"列表中的IP将被拒绝访问"})]}),e.jsxs("div",{className:"text-xs text-default-500 px-1",children:[e.jsx("div",{className:"font-medium mb-1",children:"示例规则："}),e.jsxs("div",{className:"space-y-0.5 font-mono",children:[e.jsx("div",{children:"• 127.0.0.1 (IPv4 本地回环)"}),e.jsx("div",{children:"• 192.168.1.* (IPv4 通配符)"}),e.jsx("div",{children:"• 10.0.0.0/8 (IPv4 CIDR)"}),e.jsx("div",{children:"• ::1 (IPv6 本地回环)"}),e.jsx("div",{children:"• 2001:db8::/32 (IPv6 CIDR)"})]})]})]}),e.jsx(C,{control:o,name:"enableXForwardedFor",render:({field:h})=>e.jsx(G,{value:h.value,onValueChange:m=>h.onChange(m),disabled:!!t,label:"启用 X-Forwarded-For",description:"启用后将从 X-Forwarded-For 头部获取真实IP地址（适用于反向代理场景）"})})]})]})]}),e.jsx(Q,{onSubmit:w,reset:p,isSubmitting:n||s,refresh:y})]})},Fr=()=>{const{data:r,loading:s,refreshAsync:t}=J(F.getSSLStatus),[a,l]=f.useState(""),[i,o]=f.useState(""),[c,n]=f.useState(!1);f.useEffect(()=>{r&&(l(r.certContent||""),o(r.keyContent||""))},[r]);const d=async()=>{if(!a.trim()||!i.trim()){v.error("证书和私钥内容不能为空");return}n(!0);try{const p=await F.saveSSLCert(a,i);v.success(p.message||"SSL证书保存成功"),await t()}catch(p){const w=p.message;v.error(`保存SSL证书失败: ${w}`)}finally{n(!1)}},u=async()=>{n(!0);try{const p=await F.deleteSSLCert();v.success(p.message||"SSL证书已删除"),l(""),o(""),await t()}catch(p){const w=p.message;v.error(`删除SSL证书失败: ${w}`)}finally{n(!1)}},b=async()=>{try{await t(),v.success("刷新成功")}catch(p){const w=p.message;v.error(`刷新失败: ${w}`)}};return s?e.jsx(B,{loading:!0}):e.jsxs(e.Fragment,{children:[e.jsx("title",{children:"SSL配置 - NapCat WebUI"}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-shrink-0 w-full font-bold text-default-600 dark:text-default-400 px-1",children:"SSL/HTTPS 配置"}),(r==null?void 0:r.enabled)&&e.jsx("span",{className:"px-2 py-0.5 text-xs bg-success-100 text-success-700 dark:bg-success-900/30 dark:text-success-400 rounded-full whitespace-nowrap",children:"已启用"})]}),e.jsx("p",{className:"text-sm text-default-500 px-1",children:"配置SSL证书后重启即可启用HTTPS。将证书(cert.pem)和私钥(key.pem)的内容粘贴到下方文本框中。"}),e.jsx("div",{className:"p-3 bg-warning-50 dark:bg-warning-900/20 rounded-lg border border-warning-200 dark:border-warning-800",children:e.jsxs("p",{className:"text-sm text-warning-700 dark:text-warning-400",children:[e.jsx("strong",{children:"注意："}),"保存证书后需要重启服务才能生效。删除证书后同样需要重启才能切换回HTTP模式。"]})})]}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx(Ne,{label:"证书内容 (cert.pem)",placeholder:`-----BEGIN CERTIFICATE-----
...
-----END CERTIFICATE-----`,value:a,onValueChange:l,minRows:6,maxRows:12,classNames:{inputWrapper:"bg-default-100/50 dark:bg-white/5 backdrop-blur-md border border-transparent hover:bg-default-200/50 dark:hover:bg-white/10 transition-all shadow-sm data-[hover=true]:border-default-300",input:"bg-transparent text-default-700 placeholder:text-default-400 font-mono text-sm"}}),e.jsx(Ne,{label:"私钥内容 (key.pem)",placeholder:`-----BEGIN PRIVATE KEY-----
...
-----END PRIVATE KEY-----`,value:i,onValueChange:o,minRows:6,maxRows:12,classNames:{inputWrapper:"bg-default-100/50 dark:bg-white/5 backdrop-blur-md border border-transparent hover:bg-default-200/50 dark:hover:bg-white/10 transition-all shadow-sm data-[hover=true]:border-default-300",input:"bg-transparent text-default-700 placeholder:text-default-400 font-mono text-sm"}})]}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx(S,{variant:"flat",isLoading:c||s,onPress:b,size:"sm",children:"刷新"}),(r==null?void 0:r.enabled)&&e.jsx(S,{color:"danger",variant:"flat",isLoading:c||s,onPress:u,size:"sm",children:"删除SSL证书"}),e.jsx(S,{color:"primary",isLoading:c||s,onPress:d,size:"sm",children:"保存SSL证书"})]})]})]})};function Ue(r){return ue({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z"},child:[]}]})(r)}function Ce(r){return ue({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M432 416h-23.41L277.88 53.69A32 32 0 0 0 247.58 32h-47.16a32 32 0 0 0-30.3 21.69L39.41 416H16a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h128a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16h-19.58l23.3-64h152.56l23.3 64H304a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h128a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zM176.85 272L224 142.51 271.15 272z"},child:[]}]})(r)}function Tr(r){return ue({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M64 224h13.5c24.7 56.5 80.9 96 146.5 96s121.8-39.5 146.5-96H384c8.8 0 16-7.2 16-16v-96c0-8.8-7.2-16-16-16h-13.5C345.8 39.5 289.6 0 224 0S102.2 39.5 77.5 96H64c-8.8 0-16 7.2-16 16v96c0 8.8 7.2 16 16 16zm40-88c0-22.1 21.5-40 48-40h144c26.5 0 48 17.9 48 40v24c0 53-43 96-96 96h-48c-53 0-96-43-96-96v-24zm72 72l12-36 36-12-36-12-12-36-12 36-36 12 36 12 12 36zm151.6 113.4C297.7 340.7 262.2 352 224 352s-73.7-11.3-103.6-30.6C52.9 328.5 0 385 0 454.4v9.6c0 26.5 21.5 48 48 48h80v-64c0-17.7 14.3-32 32-32h128c17.7 0 32 14.3 32 32v64h80c26.5 0 48-21.5 48-48v-9.6c0-69.4-52.9-125.9-120.4-133zM272 448c-8.8 0-16 7.2-16 16s7.2 16 16 16 16-7.2 16-16-7.2-16-16-16zm-96 0c-8.8 0-16 7.2-16 16v48h32v-48c0-8.8-7.2-16-16-16z"},child:[]}]})(r)}const Wr={dark:{"--heroui-background":"0 0% 0%","--heroui-foreground-50":"240 5.88% 10%","--heroui-foreground-100":"240 3.7% 15.88%","--heroui-foreground-200":"240 5.26% 26.08%","--heroui-foreground-300":"240 5.2% 33.92%","--heroui-foreground-400":"240 3.83% 46.08%","--heroui-foreground-500":"240 5.03% 64.9%","--heroui-foreground-600":"240 4.88% 83.92%","--heroui-foreground-700":"240 5.88% 90%","--heroui-foreground-800":"240 4.76% 95.88%","--heroui-foreground-900":"0 0% 98.04%","--heroui-foreground":"210 5.56% 92.94%","--heroui-focus":"212.01999999999998 100% 46.67%","--heroui-overlay":"0 0% 0%","--heroui-divider":"0 0% 100%","--heroui-divider-opacity":"0.15","--heroui-content1":"240 5.88% 10%","--heroui-content1-foreground":"0 0% 98.04%","--heroui-content2":"240 3.7% 15.88%","--heroui-content2-foreground":"240 4.76% 95.88%","--heroui-content3":"240 5.26% 26.08%","--heroui-content3-foreground":"240 5.88% 90%","--heroui-content4":"240 5.2% 33.92%","--heroui-content4-foreground":"240 4.88% 83.92%","--heroui-default-50":"240 5.88% 10%","--heroui-default-100":"240 3.7% 15.88%","--heroui-default-200":"240 5.26% 26.08%","--heroui-default-300":"240 5.2% 33.92%","--heroui-default-400":"240 3.83% 46.08%","--heroui-default-500":"240 5.03% 64.9%","--heroui-default-600":"240 4.88% 83.92%","--heroui-default-700":"240 5.88% 90%","--heroui-default-800":"240 4.76% 95.88%","--heroui-default-900":"0 0% 98.04%","--heroui-default-foreground":"0 0% 100%","--heroui-default":"240 5.26% 26.08%","--heroui-danger-50":"340 84.91% 10.39%","--heroui-danger-100":"339.33 86.54% 20.39%","--heroui-danger-200":"339.11 85.99% 30.78%","--heroui-danger-300":"339 86.54% 40.78%","--heroui-danger-400":"339.2 90.36% 51.18%","--heroui-danger-500":"339 90% 60.78%","--heroui-danger-600":"339.11 90.6% 70.78%","--heroui-danger-700":"339.33 90% 80.39%","--heroui-danger-800":"340 91.84% 90.39%","--heroui-danger-900":"339.13 92% 95.1%","--heroui-danger-foreground":"0 0% 100%","--heroui-danger":"339.2 90.36% 51.18%","--heroui-primary-50":"211.84 100% 9.61%","--heroui-primary-100":"211.84 100% 19.22%","--heroui-primary-200":"212.24 100% 28.82%","--heroui-primary-300":"212.14 100% 38.43%","--heroui-primary-400":"212.02 100% 46.67%","--heroui-primary-500":"212.14 92.45% 58.43%","--heroui-primary-600":"212.24 92.45% 68.82%","--heroui-primary-700":"211.84 92.45% 79.22%","--heroui-primary-800":"211.84 92.45% 89.61%","--heroui-primary-900":"212.5 92.31% 94.9%","--heroui-primary-foreground":"0 0% 100%","--heroui-primary":"212.02 100% 46.67%","--heroui-secondary-50":"270 66.67% 9.41%","--heroui-secondary-100":"270 66.67% 18.82%","--heroui-secondary-200":"270 66.67% 28.24%","--heroui-secondary-300":"270 66.67% 37.65%","--heroui-secondary-400":"270 66.67% 47.06%","--heroui-secondary-500":"270 59.26% 57.65%","--heroui-secondary-600":"270 59.26% 68.24%","--heroui-secondary-700":"270 59.26% 78.82%","--heroui-secondary-800":"270 59.26% 89.41%","--heroui-secondary-900":"270 61.54% 94.9%","--heroui-secondary-foreground":"0 0% 100%","--heroui-secondary":"270 59.26% 57.65%","--heroui-success-50":"145.71 77.78% 8.82%","--heroui-success-100":"146.2 79.78% 17.45%","--heroui-success-200":"145.79 79.26% 26.47%","--heroui-success-300":"146.01 79.89% 35.1%","--heroui-success-400":"145.96 79.46% 43.92%","--heroui-success-500":"146.01 62.45% 55.1%","--heroui-success-600":"145.79 62.57% 66.47%","--heroui-success-700":"146.2 61.74% 77.45%","--heroui-success-800":"145.71 61.4% 88.82%","--heroui-success-900":"146.67 64.29% 94.51%","--heroui-success-foreground":"0 0% 0%","--heroui-success":"145.96 79.46% 43.92%","--heroui-warning-50":"37.14 75% 10.98%","--heroui-warning-100":"37.14 75% 21.96%","--heroui-warning-200":"36.96 73.96% 33.14%","--heroui-warning-300":"37.01 74.22% 44.12%","--heroui-warning-400":"37.03 91.27% 55.1%","--heroui-warning-500":"37.01 91.26% 64.12%","--heroui-warning-600":"36.96 91.24% 73.14%","--heroui-warning-700":"37.14 91.3% 81.96%","--heroui-warning-800":"37.14 91.3% 90.98%","--heroui-warning-900":"54.55 91.67% 95.29%","--heroui-warning-foreground":"0 0% 0%","--heroui-warning":"37.03 91.27% 55.1%","--heroui-code-background":"240 5.56% 7.06%","--heroui-strong":"190.14 94.67% 44.12%","--heroui-code-mdx":"190.14 94.67% 44.12%","--heroui-divider-weight":"1px","--heroui-disabled-opacity":".5","--heroui-font-size-tiny":"0.75rem","--heroui-font-size-small":"0.875rem","--heroui-font-size-medium":"1rem","--heroui-font-size-large":"1.125rem","--heroui-line-height-tiny":"1rem","--heroui-line-height-small":"1.25rem","--heroui-line-height-medium":"1.5rem","--heroui-line-height-large":"1.75rem","--heroui-radius-small":"8px","--heroui-radius-medium":"12px","--heroui-radius-large":"14px","--heroui-border-width-small":"1px","--heroui-border-width-medium":"2px","--heroui-border-width-large":"3px","--heroui-box-shadow-small":"0px 0px 5px 0px rgba(0, 0, 0, .05), 0px 2px 10px 0px rgba(0, 0, 0, .2), inset 0px 0px 1px 0px hsla(0, 0%, 100%, .15)","--heroui-box-shadow-medium":"0px 0px 15px 0px rgba(0, 0, 0, .06), 0px 2px 30px 0px rgba(0, 0, 0, .22), inset 0px 0px 1px 0px hsla(0, 0%, 100%, .15)","--heroui-box-shadow-large":"0px 0px 30px 0px rgba(0, 0, 0, .07), 0px 30px 60px 0px rgba(0, 0, 0, .26), inset 0px 0px 1px 0px hsla(0, 0%, 100%, .15)","--heroui-hover-opacity":".9"},light:{"--heroui-background":"0 0% 100%","--heroui-foreground-50":"240 5.88% 95%","--heroui-foreground-100":"240 3.7% 90%","--heroui-foreground-200":"240 5.26% 80%","--heroui-foreground-300":"240 5.2% 70%","--heroui-foreground-400":"240 3.83% 60%","--heroui-foreground-500":"240 5.03% 50%","--heroui-foreground-600":"240 4.88% 40%","--heroui-foreground-700":"240 5.88% 30%","--heroui-foreground-800":"240 4.76% 20%","--heroui-foreground-900":"0 0% 10%","--heroui-foreground":"210 5.56% 7.06%","--heroui-focus":"212.01999999999998 100% 53.33%","--heroui-overlay":"0 0% 100%","--heroui-divider":"0 0% 0%","--heroui-divider-opacity":"0.85","--heroui-content1":"240 5.88% 95%","--heroui-content1-foreground":"0 0% 10%","--heroui-content2":"240 3.7% 90%","--heroui-content2-foreground":"240 4.76% 20%","--heroui-content3":"240 5.26% 80%","--heroui-content3-foreground":"240 5.88% 30%","--heroui-content4":"240 5.2% 70%","--heroui-content4-foreground":"240 4.88% 40%","--heroui-default-50":"240 5.88% 95%","--heroui-default-100":"240 3.7% 90%","--heroui-default-200":"240 5.26% 80%","--heroui-default-300":"240 5.2% 70%","--heroui-default-400":"240 3.83% 60%","--heroui-default-500":"240 5.03% 50%","--heroui-default-600":"240 4.88% 40%","--heroui-default-700":"240 5.88% 30%","--heroui-default-800":"240 4.76% 20%","--heroui-default-900":"0 0% 10%","--heroui-default-foreground":"0 0% 0%","--heroui-default":"240 5.26% 80%","--heroui-danger-50":"339.13 92% 95.1%","--heroui-danger-100":"340 91.84% 90.39%","--heroui-danger-200":"339.33 90% 80.39%","--heroui-danger-300":"339.11 90.6% 70.78%","--heroui-danger-400":"339 90% 60.78%","--heroui-danger-500":"339.2 90.36% 51.18%","--heroui-danger-600":"339 86.54% 40.78%","--heroui-danger-700":"339.11 85.99% 30.78%","--heroui-danger-800":"339.33 86.54% 20.39%","--heroui-danger-900":"340 84.91% 10.39%","--heroui-danger-foreground":"0 0% 100%","--heroui-danger":"339.2 90.36% 51.18%","--heroui-primary-50":"212.5 92.31% 94.9%","--heroui-primary-100":"211.84 92.45% 89.61%","--heroui-primary-200":"211.84 92.45% 79.22%","--heroui-primary-300":"212.24 92.45% 68.82%","--heroui-primary-400":"212.14 92.45% 58.43%","--heroui-primary-500":"212.02 100% 46.67%","--heroui-primary-600":"212.14 100% 38.43%","--heroui-primary-700":"212.24 100% 28.82%","--heroui-primary-800":"211.84 100% 19.22%","--heroui-primary-900":"211.84 100% 9.61%","--heroui-primary-foreground":"0 0% 100%","--heroui-primary":"212.02 100% 46.67%","--heroui-secondary-50":"270 61.54% 94.9%","--heroui-secondary-100":"270 59.26% 89.41%","--heroui-secondary-200":"270 59.26% 78.82%","--heroui-secondary-300":"270 59.26% 68.24%","--heroui-secondary-400":"270 59.26% 57.65%","--heroui-secondary-500":"270 66.67% 47.06%","--heroui-secondary-600":"270 66.67% 37.65%","--heroui-secondary-700":"270 66.67% 28.24%","--heroui-secondary-800":"270 66.67% 18.82%","--heroui-secondary-900":"270 66.67% 9.41%","--heroui-secondary-foreground":"0 0% 100%","--heroui-secondary":"270 66.67% 47.06%","--heroui-success-50":"146.67 64.29% 94.51%","--heroui-success-100":"145.71 61.4% 88.82%","--heroui-success-200":"146.2 61.74% 77.45%","--heroui-success-300":"145.79 62.57% 66.47%","--heroui-success-400":"146.01 62.45% 55.1%","--heroui-success-500":"145.96 79.46% 43.92%","--heroui-success-600":"146.01 79.89% 35.1%","--heroui-success-700":"145.79 79.26% 26.47%","--heroui-success-800":"146.2 79.78% 17.45%","--heroui-success-900":"145.71 77.78% 8.82%","--heroui-success-foreground":"0 0% 0%","--heroui-success":"145.96 79.46% 43.92%","--heroui-warning-50":"54.55 91.67% 95.29%","--heroui-warning-100":"37.14 91.3% 90.98%","--heroui-warning-200":"37.14 91.3% 81.96%","--heroui-warning-300":"36.96 91.24% 73.14%","--heroui-warning-400":"37.01 91.26% 64.12%","--heroui-warning-500":"37.03 91.27% 55.1%","--heroui-warning-600":"37.01 74.22% 44.12%","--heroui-warning-700":"36.96 73.96% 33.14%","--heroui-warning-800":"37.14 75% 21.96%","--heroui-warning-900":"37.14 75% 10.98%","--heroui-warning-foreground":"0 0% 0%","--heroui-warning":"37.03 91.27% 55.1%","--heroui-code-background":"221.25 17.39% 18.04%","--heroui-strong":"316.95 100% 65.29%","--heroui-code-mdx":"316.95 100% 65.29%","--heroui-divider-weight":"1px","--heroui-disabled-opacity":".5","--heroui-font-size-tiny":"0.75rem","--heroui-font-size-small":"0.875rem","--heroui-font-size-medium":"1rem","--heroui-font-size-large":"1.125rem","--heroui-line-height-tiny":"1rem","--heroui-line-height-small":"1.25rem","--heroui-line-height-medium":"1.5rem","--heroui-line-height-large":"1.75rem","--heroui-radius-small":"8px","--heroui-radius-medium":"12px","--heroui-radius-large":"14px","--heroui-border-width-small":"1px","--heroui-border-width-medium":"2px","--heroui-border-width-large":"3px","--heroui-box-shadow-small":"0px 0px 5px 0px rgba(0, 0, 0, .02), 0px 2px 10px 0px rgba(0, 0, 0, .06), 0px 0px 1px 0px rgba(0, 0, 0, .3)","--heroui-box-shadow-medium":"0px 0px 15px 0px rgba(0, 0, 0, .03), 0px 2px 30px 0px rgba(0, 0, 0, .08), 0px 0px 1px 0px rgba(0, 0, 0, .3)","--heroui-box-shadow-large":"0px 0px 30px 0px rgba(0, 0, 0, .04), 0px 30px 60px 0px rgba(0, 0, 0, .12), 0px 0px 1px 0px rgba(0, 0, 0, .3)","--heroui-hover-opacity":".8"}},Ur={theme:Wr,author:"HeroUI",name:"heroui",description:"HeroUI Default Theme"},Hr={dark:{"--heroui-background":"0 0% 0%","--heroui-foreground-50":"240 5.88% 10%","--heroui-foreground-100":"240 3.7% 15.88%","--heroui-foreground-200":"240 5.26% 26.08%","--heroui-foreground-300":"240 5.2% 33.92%","--heroui-foreground-400":"240 3.83% 46.08%","--heroui-foreground-500":"240 5.03% 64.9%","--heroui-foreground-600":"240 4.88% 83.92%","--heroui-foreground-700":"240 5.88% 90%","--heroui-foreground-800":"240 4.76% 95.88%","--heroui-foreground-900":"0 0% 98.04%","--heroui-foreground":"210 5.56% 92.94%","--heroui-focus":"212.01999999999998 100% 46.67%","--heroui-overlay":"0 0% 0%","--heroui-divider":"0 0% 100%","--heroui-divider-opacity":"0.15","--heroui-content1":"240 5.88% 10%","--heroui-content1-foreground":"0 0% 98.04%","--heroui-content2":"240 3.7% 15.88%","--heroui-content2-foreground":"240 4.76% 95.88%","--heroui-content3":"240 5.26% 26.08%","--heroui-content3-foreground":"240 5.88% 90%","--heroui-content4":"240 5.2% 33.92%","--heroui-content4-foreground":"240 4.88% 83.92%","--heroui-default-50":"240 5.88% 10%","--heroui-default-100":"240 3.7% 15.88%","--heroui-default-200":"240 5.26% 26.08%","--heroui-default-300":"240 5.2% 33.92%","--heroui-default-400":"240 3.83% 46.08%","--heroui-default-500":"240 5.03% 64.9%","--heroui-default-600":"240 4.88% 83.92%","--heroui-default-700":"240 5.88% 90%","--heroui-default-800":"240 4.76% 95.88%","--heroui-default-900":"0 0% 98.04%","--heroui-default-foreground":"0 0% 100%","--heroui-default":"240 5.26% 26.08%","--heroui-danger-50":"301.89 82.61% 22.55%","--heroui-danger-100":"308.18 76.39% 28.24%","--heroui-danger-200":"313.85 70.65% 36.08%","--heroui-danger-300":"319.73 65.64% 44.51%","--heroui-danger-400":"325.82 69.62% 53.53%","--heroui-danger-500":"331.82 75% 65.49%","--heroui-danger-600":"337.84 83.46% 73.92%","--heroui-danger-700":"343.42 90.48% 83.53%","--heroui-danger-800":"350.53 90.48% 91.76%","--heroui-danger-900":"324 90.91% 95.69%","--heroui-danger-foreground":"0 0% 100%","--heroui-danger":"325.82 69.62% 53.53%","--heroui-primary-50":"340 84.91% 10.39%","--heroui-primary-100":"339.33 86.54% 20.39%","--heroui-primary-200":"339.11 85.99% 30.78%","--heroui-primary-300":"339 86.54% 40.78%","--heroui-primary-400":"339.2 90.36% 51.18%","--heroui-primary-500":"339 90% 60.78%","--heroui-primary-600":"339.11 90.6% 70.78%","--heroui-primary-700":"339.33 90% 80.39%","--heroui-primary-800":"340 91.84% 90.39%","--heroui-primary-900":"339.13 92% 95.1%","--heroui-primary-foreground":"0 0% 100%","--heroui-primary":"339.2 90.36% 51.18%","--heroui-secondary-50":"270 66.67% 9.41%","--heroui-secondary-100":"270 66.67% 18.82%","--heroui-secondary-200":"270 66.67% 28.24%","--heroui-secondary-300":"270 66.67% 37.65%","--heroui-secondary-400":"270 66.67% 47.06%","--heroui-secondary-500":"270 59.26% 57.65%","--heroui-secondary-600":"270 59.26% 68.24%","--heroui-secondary-700":"270 59.26% 78.82%","--heroui-secondary-800":"270 59.26% 89.41%","--heroui-secondary-900":"270 61.54% 94.9%","--heroui-secondary-foreground":"0 0% 100%","--heroui-secondary":"270 59.26% 57.65%","--heroui-success-50":"145.71 77.78% 8.82%","--heroui-success-100":"146.2 79.78% 17.45%","--heroui-success-200":"145.79 79.26% 26.47%","--heroui-success-300":"146.01 79.89% 35.1%","--heroui-success-400":"145.96 79.46% 43.92%","--heroui-success-500":"146.01 62.45% 55.1%","--heroui-success-600":"145.79 62.57% 66.47%","--heroui-success-700":"146.2 61.74% 77.45%","--heroui-success-800":"145.71 61.4% 88.82%","--heroui-success-900":"146.67 64.29% 94.51%","--heroui-success-foreground":"0 0% 0%","--heroui-success":"145.96 79.46% 43.92%","--heroui-warning-50":"37.14 75% 10.98%","--heroui-warning-100":"37.14 75% 21.96%","--heroui-warning-200":"36.96 73.96% 33.14%","--heroui-warning-300":"37.01 74.22% 44.12%","--heroui-warning-400":"37.03 91.27% 55.1%","--heroui-warning-500":"37.01 91.26% 64.12%","--heroui-warning-600":"36.96 91.24% 73.14%","--heroui-warning-700":"37.14 91.3% 81.96%","--heroui-warning-800":"37.14 91.3% 90.98%","--heroui-warning-900":"54.55 91.67% 95.29%","--heroui-warning-foreground":"0 0% 0%","--heroui-warning":"37.03 91.27% 55.1%","--heroui-code-background":"240 5.56% 7.06%","--heroui-strong":"190.14 94.67% 44.12%","--heroui-code-mdx":"190.14 94.67% 44.12%","--heroui-divider-weight":"1px","--heroui-disabled-opacity":".5","--heroui-font-size-tiny":"0.75rem","--heroui-font-size-small":"0.875rem","--heroui-font-size-medium":"1rem","--heroui-font-size-large":"1.125rem","--heroui-line-height-tiny":"1rem","--heroui-line-height-small":"1.25rem","--heroui-line-height-medium":"1.5rem","--heroui-line-height-large":"1.75rem","--heroui-radius-small":"8px","--heroui-radius-medium":"12px","--heroui-radius-large":"14px","--heroui-border-width-small":"1px","--heroui-border-width-medium":"2px","--heroui-border-width-large":"3px","--heroui-box-shadow-small":"0px 0px 5px 0px rgba(0, 0, 0, .05), 0px 2px 10px 0px rgba(0, 0, 0, .2), inset 0px 0px 1px 0px hsla(0, 0%, 100%, .15)","--heroui-box-shadow-medium":"0px 0px 15px 0px rgba(0, 0, 0, .06), 0px 2px 30px 0px rgba(0, 0, 0, .22), inset 0px 0px 1px 0px hsla(0, 0%, 100%, .15)","--heroui-box-shadow-large":"0px 0px 30px 0px rgba(0, 0, 0, .07), 0px 30px 60px 0px rgba(0, 0, 0, .26), inset 0px 0px 1px 0px hsla(0, 0%, 100%, .15)","--heroui-hover-opacity":".9"},light:{"--heroui-background":"0 0% 100%","--heroui-foreground-50":"240 5.88% 95%","--heroui-foreground-100":"240 3.7% 90%","--heroui-foreground-200":"240 5.26% 80%","--heroui-foreground-300":"240 5.2% 70%","--heroui-foreground-400":"240 3.83% 60%","--heroui-foreground-500":"240 5.03% 50%","--heroui-foreground-600":"240 4.88% 40%","--heroui-foreground-700":"240 5.88% 30%","--heroui-foreground-800":"240 4.76% 20%","--heroui-foreground-900":"0 0% 10%","--heroui-foreground":"210 5.56% 7.06%","--heroui-focus":"212.01999999999998 100% 53.33%","--heroui-overlay":"0 0% 100%","--heroui-divider":"0 0% 0%","--heroui-divider-opacity":"0.85","--heroui-content1":"240 5.88% 95%","--heroui-content1-foreground":"0 0% 10%","--heroui-content2":"240 3.7% 90%","--heroui-content2-foreground":"240 4.76% 20%","--heroui-content3":"240 5.26% 80%","--heroui-content3-foreground":"240 5.88% 30%","--heroui-content4":"240 5.2% 70%","--heroui-content4-foreground":"240 4.88% 40%","--heroui-default-50":"240 5.88% 95%","--heroui-default-100":"240 3.7% 90%","--heroui-default-200":"240 5.26% 80%","--heroui-default-300":"240 5.2% 70%","--heroui-default-400":"240 3.83% 60%","--heroui-default-500":"240 5.03% 50%","--heroui-default-600":"240 4.88% 40%","--heroui-default-700":"240 5.88% 30%","--heroui-default-800":"240 4.76% 20%","--heroui-default-900":"0 0% 10%","--heroui-default-foreground":"0 0% 0%","--heroui-default":"240 5.26% 80%","--heroui-danger-50":"324 90.91% 95.69%","--heroui-danger-100":"350.53 90.48% 91.76%","--heroui-danger-200":"343.42 90.48% 83.53%","--heroui-danger-300":"337.84 83.46% 73.92%","--heroui-danger-400":"331.82 75% 65.49%","--heroui-danger-500":"325.82 69.62% 53.53%","--heroui-danger-600":"319.73 65.64% 44.51%","--heroui-danger-700":"313.85 70.65% 36.08%","--heroui-danger-800":"308.18 76.39% 28.24%","--heroui-danger-900":"301.89 82.61% 22.55%","--heroui-danger-foreground":"0 0% 100%","--heroui-danger":"325.82 69.62% 53.53%","--heroui-primary-50":"339.13 92% 95.1%","--heroui-primary-100":"340 91.84% 90.39%","--heroui-primary-200":"339.33 90% 80.39%","--heroui-primary-300":"339.11 90.6% 70.78%","--heroui-primary-400":"339 90% 60.78%","--heroui-primary-500":"339.2 90.36% 51.18%","--heroui-primary-600":"339 86.54% 40.78%","--heroui-primary-700":"339.11 85.99% 30.78%","--heroui-primary-800":"339.33 86.54% 20.39%","--heroui-primary-900":"340 84.91% 10.39%","--heroui-primary-foreground":"0 0% 100%","--heroui-primary":"339.2 90.36% 60%","--heroui-secondary-50":"270 61.54% 94.9%","--heroui-secondary-100":"270 59.26% 89.41%","--heroui-secondary-200":"270 59.26% 78.82%","--heroui-secondary-300":"270 59.26% 68.24%","--heroui-secondary-400":"270 59.26% 57.65%","--heroui-secondary-500":"270 66.67% 47.06%","--heroui-secondary-600":"270 66.67% 37.65%","--heroui-secondary-700":"270 66.67% 28.24%","--heroui-secondary-800":"270 66.67% 18.82%","--heroui-secondary-900":"270 66.67% 9.41%","--heroui-secondary-foreground":"0 0% 100%","--heroui-secondary":"270 66.67% 47.06%","--heroui-success-50":"146.67 64.29% 94.51%","--heroui-success-100":"145.71 61.4% 88.82%","--heroui-success-200":"146.2 61.74% 77.45%","--heroui-success-300":"145.79 62.57% 66.47%","--heroui-success-400":"146.01 62.45% 55.1%","--heroui-success-500":"145.96 79.46% 43.92%","--heroui-success-600":"146.01 79.89% 35.1%","--heroui-success-700":"145.79 79.26% 26.47%","--heroui-success-800":"146.2 79.78% 17.45%","--heroui-success-900":"145.71 77.78% 8.82%","--heroui-success-foreground":"0 0% 0%","--heroui-success":"145.96 79.46% 43.92%","--heroui-warning-50":"54.55 91.67% 95.29%","--heroui-warning-100":"37.14 91.3% 90.98%","--heroui-warning-200":"37.14 91.3% 81.96%","--heroui-warning-300":"36.96 91.24% 73.14%","--heroui-warning-400":"37.01 91.26% 64.12%","--heroui-warning-500":"37.03 91.27% 55.1%","--heroui-warning-600":"37.01 74.22% 44.12%","--heroui-warning-700":"36.96 73.96% 33.14%","--heroui-warning-800":"37.14 75% 21.96%","--heroui-warning-900":"37.14 75% 10.98%","--heroui-warning-foreground":"0 0% 0%","--heroui-warning":"37.03 91.27% 55.1%","--heroui-code-background":"221.25 17.39% 18.04%","--heroui-strong":"316.95 100% 65.29%","--heroui-code-mdx":"316.95 100% 65.29%","--heroui-divider-weight":"1px","--heroui-disabled-opacity":".5","--heroui-font-size-tiny":"0.75rem","--heroui-font-size-small":"0.875rem","--heroui-font-size-medium":"1rem","--heroui-font-size-large":"1.125rem","--heroui-line-height-tiny":"1rem","--heroui-line-height-small":"1.25rem","--heroui-line-height-medium":"1.5rem","--heroui-line-height-large":"1.75rem","--heroui-radius-small":"8px","--heroui-radius-medium":"12px","--heroui-radius-large":"14px","--heroui-border-width-small":"1px","--heroui-border-width-medium":"2px","--heroui-border-width-large":"3px","--heroui-box-shadow-small":"0px 0px 5px 0px rgba(0, 0, 0, .02), 0px 2px 10px 0px rgba(0, 0, 0, .06), 0px 0px 1px 0px rgba(0, 0, 0, .3)","--heroui-box-shadow-medium":"0px 0px 15px 0px rgba(0, 0, 0, .03), 0px 2px 30px 0px rgba(0, 0, 0, .08), 0px 0px 1px 0px rgba(0, 0, 0, .3)","--heroui-box-shadow-large":"0px 0px 30px 0px rgba(0, 0, 0, .04), 0px 30px 60px 0px rgba(0, 0, 0, .12), 0px 0px 1px 0px rgba(0, 0, 0, .3)","--heroui-hover-opacity":".8"}},Dr={theme:Hr,author:"NapCat",name:"nc_pink",description:"NapCat Pink Theme"},ae=[Dr,Ur],Se=r=>{const s=r.match(/hsl\((\d+(?:\.\d+)?),\s*(\d+(?:\.\d+)?)%,\s*(\d+(?:\.\d+)?)%\)/);return s?{h:parseFloat(s[1]),s:parseFloat(s[2]),l:parseFloat(s[3])}:{h:0,s:0,l:0}},_r=r=>{let s=0,t=0,a=0;r.length===4?(s=parseInt("0x"+r[1]+r[1]),t=parseInt("0x"+r[2]+r[2]),a=parseInt("0x"+r[3]+r[3])):r.length===7&&(s=parseInt("0x"+r[1]+r[2]),t=parseInt("0x"+r[3]+r[4]),a=parseInt("0x"+r[5]+r[6])),s/=255,t/=255,a/=255;const l=Math.min(s,t,a),i=Math.max(s,t,a),o=i-l;let c=0,n=0,d=0;return o===0?c=0:i===s?c=(t-a)/o%6:i===t?c=(a-s)/o+2:c=(s-t)/o+4,c=Math.round(c*60),c<0&&(c+=360),d=(i+l)/2,n=o===0?0:o/(1-Math.abs(2*d-1)),n=+(n*100).toFixed(1),d=+(d*100).toFixed(1),{h:c,s:n,l:d}},oe=(r,s,t)=>{s/=100,t/=100;const a=(1-Math.abs(2*t-1))*s,l=a*(1-Math.abs(r/60%2-1)),i=t-a/2;let o=0,c=0,n=0;0<=r&&r<60?(o=a,c=l,n=0):60<=r&&r<120?(o=l,c=a,n=0):120<=r&&r<180?(o=0,c=a,n=l):180<=r&&r<240?(o=0,c=l,n=a):240<=r&&r<300?(o=l,c=0,n=a):300<=r&&r<360&&(o=a,c=0,n=l),o=Math.round((o+i)*255),c=Math.round((c+i)*255),n=Math.round((n+i)*255);const d=u=>{const b=u.toString(16);return b.length===1?"0"+b:b};return"#"+d(o)+d(c)+d(n)},He=f.memo(({hsl:r,onChange:s})=>{const t=f.useRef(null),[a,l]=f.useState(!1),i=f.useRef(r);f.useEffect(()=>{i.current=r},[r]);const o=f.useCallback((m,g)=>{if(!t.current)return;const k=t.current.getBoundingClientRect(),N=Math.max(0,Math.min(1,(m-k.left)/k.width)),L=Math.max(0,Math.min(1,(g-k.top)/k.height)),M=N,R=1-L;let E=R*(1-M/2),x=0;E===0||E===1?x=0:x=(R-E)/Math.min(E,1-E),s({h:i.current.h,s:x*100,l:E*100})},[s]),c=(m,g)=>{l(!0),o(m,g)},n=m=>{m.preventDefault(),c(m.clientX,m.clientY)},d=m=>{m.preventDefault();const g=m.touches[0];c(g.clientX,g.clientY)};f.useEffect(()=>{const m=N=>{a&&(N.preventDefault(),o(N.clientX,N.clientY))},g=N=>{if(a){N.preventDefault();const L=N.touches[0];o(L.clientX,L.clientY)}},k=()=>{l(!1)};return a&&(window.addEventListener("mousemove",m),window.addEventListener("mouseup",k),window.addEventListener("touchmove",g,{passive:!1}),window.addEventListener("touchend",k)),()=>{window.removeEventListener("mousemove",m),window.removeEventListener("mouseup",k),window.removeEventListener("touchmove",g),window.removeEventListener("touchend",k)}},[a,o]);const u=r.l/100,b=r.s/100,p=u+b*Math.min(u,1-u),y=(p===0?0:2*(1-u/p))*100,h=(1-p)*100;return e.jsx("div",{ref:t,className:"w-full h-40 rounded-lg relative cursor-crosshair overflow-hidden shadow-inner touch-none",style:{backgroundColor:"hsl("+r.h+", 100%, 50%)",backgroundImage:"linear-gradient(to top, #000, transparent), linear-gradient(to right, #fff, transparent)"},onMouseDown:n,onTouchStart:d,children:e.jsx("div",{className:"w-4 h-4 rounded-full border-2 border-white shadow-md absolute transform -translate-x-1/2 -translate-y-1/2 pointer-events-none",style:{left:y+"%",top:h+"%",backgroundColor:"hsl("+r.h+", "+r.s+"%, "+r.l+"%)"}})})});He.displayName="SatLightPanel";const De=f.memo(({hsl:r,onChange:s})=>{const t=f.useRef(null),[a,l]=f.useState(!1),i=f.useRef(r);f.useEffect(()=>{i.current=r},[r]);const o=f.useCallback(u=>{if(!t.current)return;const b=t.current.getBoundingClientRect();let p=(u-b.left)/b.width;p=Math.max(0,Math.min(1,p)),s({...i.current,h:p*360})},[s]),c=u=>{l(!0),o(u)},n=u=>{u.preventDefault(),c(u.clientX)},d=u=>{u.preventDefault();const b=u.touches[0];c(b.clientX)};return f.useEffect(()=>{const u=w=>{a&&(w.preventDefault(),o(w.clientX))},b=w=>{if(a){w.preventDefault();const y=w.touches[0];o(y.clientX)}},p=()=>{l(!1)};return a&&(window.addEventListener("mousemove",u),window.addEventListener("mouseup",p),window.addEventListener("touchmove",b,{passive:!1}),window.addEventListener("touchend",p)),()=>{window.removeEventListener("mousemove",u),window.removeEventListener("mouseup",p),window.removeEventListener("touchmove",b),window.removeEventListener("touchend",p)}},[a,o]),e.jsx("div",{ref:t,className:"w-full h-4 rounded-full relative cursor-pointer mt-3 shadow-inner touch-none",style:{background:"linear-gradient(to right, #f00 0%, #ff0 17%, #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%)"},onMouseDown:n,onTouchStart:d,children:e.jsx("div",{className:"w-4 h-4 rounded-full border-2 border-white shadow-md absolute top-0 transform -translate-x-1/2 pointer-events-none bg-white",style:{left:r.h/360*100+"%"}})})});De.displayName="HueSlider";const Or=({color:r,onChange:s})=>{const[t,a]=f.useState(Se(r)),[l,i]=f.useState(oe(t.h,t.s,t.l)),o=f.useRef(!1);f.useEffect(()=>{if(o.current)return;const d=Se(r);(Math.abs(d.h-t.h)>.1||Math.abs(d.s-t.s)>.1||Math.abs(d.l-t.l)>.1)&&(a(d),i(oe(d.h,d.s,d.l)))},[r]);const c=f.useCallback(d=>{a(d),i(oe(d.h,d.s,d.l)),s("hsl("+Math.round(d.h)+", "+Math.round(d.s)+"%, "+Math.round(d.l)+"%)")},[s]),n=d=>{if(i(d),/^#[0-9A-Fa-f]{6}$/.test(d)){const u=_r(d);c(u)}};return e.jsxs(lr,{triggerScaleOnOpen:!1,placement:"bottom",children:[e.jsx(dr,{children:e.jsxs("div",{className:"flex items-center gap-2 cursor-pointer group",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg shadow-sm border-2 border-default-200 transition-transform group-hover:scale-105",style:{background:r}}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-xs font-mono text-default-500",children:l}),e.jsxs("span",{className:"text-xs font-mono text-default-400",children:["HSL(",Math.round(t.h),", ",Math.round(t.s),"%, ",Math.round(t.l),"%)"]})]})]})}),e.jsx(ur,{className:"w-72 p-4 bg-background/80 backdrop-blur-xl border border-default-200 shadow-2xl rounded-2xl",onMouseDownCapture:()=>{o.current=!0},onMouseUpCapture:()=>{o.current=!1},onTouchStartCapture:()=>{o.current=!0},onTouchEndCapture:()=>{o.current=!1},children:e.jsxs("div",{className:"flex flex-col w-full gap-2",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-bold text-default-700",children:"选择颜色"}),e.jsx("div",{className:"w-6 h-6 rounded-full border border-default-200 shadow-sm",style:{background:r}})]}),e.jsx(He,{hsl:t,onChange:c}),e.jsx(De,{hsl:t,onChange:c}),e.jsxs("div",{className:"grid grid-cols-4 gap-2 mt-2 items-center",children:[e.jsx("span",{className:"text-xs text-default-500 col-span-1",children:"HEX"}),e.jsx(z,{size:"sm",variant:"flat",value:l,onChange:d=>n(d.target.value),className:"col-span-3 font-mono",classNames:{input:"text-xs uppercase",inputWrapper:"h-8 min-h-8"}})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-2 items-center",children:[e.jsx("span",{className:"text-xs text-default-500 col-span-1",children:"HSL"}),e.jsxs("div",{className:"col-span-3 flex gap-1",children:[e.jsx(z,{size:"sm",variant:"flat",type:"number",value:Math.round(t.h).toString(),onChange:d=>c({...t,h:Number(d.target.value)}),endContent:e.jsx("span",{className:"text-xs text-default-400",children:"H"}),classNames:{input:"text-xs",inputWrapper:"h-8 min-h-8 px-1"}}),e.jsx(z,{size:"sm",variant:"flat",type:"number",value:Math.round(t.s).toString(),onChange:d=>c({...t,s:Number(d.target.value)}),endContent:e.jsx("span",{className:"text-xs text-default-400",children:"S"}),classNames:{input:"text-xs",inputWrapper:"h-8 min-h-8 px-1"}}),e.jsx(z,{size:"sm",variant:"flat",type:"number",value:Math.round(t.l).toString(),onChange:d=>c({...t,l:Number(d.target.value)}),endContent:e.jsx("span",{className:"text-xs text-default-400",children:"L"}),classNames:{input:"text-xs",inputWrapper:"h-8 min-h-8 px-1"}})]})]}),e.jsx("div",{className:"flex gap-1 mt-2 flex-wrap justify-between",children:["#006FEE","#17C964","#F5A524","#F31260","#7828C8","#000000","#FFFFFF"].map(d=>e.jsx("button",{className:"w-6 h-6 rounded-full border border-default-200 shadow-sm transition-transform hover:scale-110 active:scale-95",style:{backgroundColor:d},onClick:()=>n(d)},d))})]})})]})},$r=({onChange:r,onDelete:s,label:t,accept:a,placeholder:l})=>{const i=f.useRef(null),[o,c]=f.useState(!1);return e.jsxs("div",{className:"flex items-end gap-2",children:[e.jsx("div",{className:"flex-grow",children:e.jsx(z,{isDisabled:o,ref:i,label:t,type:"file",placeholder:l||"选择文件",accept:a,classNames:{inputWrapper:"bg-default-100/50 dark:bg-white/5 backdrop-blur-md border border-transparent hover:bg-default-200/50 dark:hover:bg-white/10 transition-all shadow-sm data-[hover=true]:border-default-300",input:"bg-transparent text-default-700 placeholder:text-default-400"},onChange:async n=>{var d;try{c(!0);const u=(d=n.target.files)==null?void 0:d[0];u&&await r(u)}catch(u){console.error(u)}finally{c(!1),i.current&&(i.current.value="")}}})}),e.jsx(S,{isDisabled:o,onPress:async()=>{try{c(!0),s&&await s()}catch(n){console.error(n)}finally{c(!1),i.current&&(i.current.value="")}},color:"primary",variant:"flat",size:"sm",children:"删除"})]})},Ar=["","-50","-100","-200","-300","-400","-500","-600","-700","-800","-900"],Br=["primary","secondary","success","danger","warning","default"];function Qr({theme:r,onPreview:s,isSelected:t}){const a=document.createElement("style");a.innerHTML=Re(r.theme,r.name);const l=f.useRef(null);return f.useEffect(()=>(document.head.appendChild(a),()=>{document.head.removeChild(a)}),[]),e.jsxs(q,{ref:l,shadow:"sm",radius:"sm",isPressable:!0,onPress:s,className:W("text-primary bg-primary-50 relative transition-all",r.name,t&&"ring-2 ring-primary ring-offset-2"),children:[t&&e.jsx("div",{className:"absolute top-1 right-1 z-10",children:e.jsx(Te,{size:"sm",color:"primary",variant:"solid",children:e.jsx(Ue,{size:10})})}),e.jsxs(Ie,{className:"pb-0 flex flex-col items-start gap-1",children:[e.jsx("div",{className:"px-1 rounded-md bg-primary text-primary-foreground",children:r.name}),e.jsxs("div",{className:"text-xs flex items-center gap-1 text-primary-300",children:[e.jsx(Tr,{}),r.author??"未知"]}),e.jsx("div",{className:"text-xs text-primary-200 whitespace-nowrap overflow-hidden text-ellipsis w-full",children:r.description})]}),e.jsx(K,{children:e.jsx("div",{className:"flex flex-col gap-1",children:Br.map(i=>e.jsxs("div",{className:"flex gap-1 items-center flex-nowrap",children:[e.jsx("div",{className:"text-xs w-4 text-right flex-shrink-0",children:i[0].toUpperCase()}),Ar.map(o=>e.jsx("div",{className:W("w-2 h-2 rounded-full shadow-small flex-shrink-0",`bg-${i}${o}`)},o))]},i))})})]})}const ne=(r,s)=>{var l,i,o,c;if(!r||!s)return!1;const t=[...Object.keys(r.light||{}),...Object.keys(r.dark||{})],a=[...Object.keys(s.light||{}),...Object.keys(s.dark||{})];if(t.length!==a.length)return!1;for(const n of Object.keys(r.light||{}))if(((l=r.light)==null?void 0:l[n])!==((i=s.light)==null?void 0:i[n]))return!1;for(const n of Object.keys(r.dark||{}))if(((o=r.dark)==null?void 0:o[n])!==((c=s.dark)==null?void 0:c[n]))return!1;return!0},Vr={aacute:"Aa 偷吃可爱长大的",system:"系统默认",custom:"自定义字体"},Xr=()=>{const{data:r,loading:s,error:t,refreshAsync:a}=J(F.getThemeConfig),{control:l,handleSubmit:i,formState:{isSubmitting:o},setValue:c}=_({defaultValues:{theme:{dark:{},light:{},fontMode:"aacute"}}}),[n,d]=f.useState(!1),[u,b]=f.useState(!1),[p,w]=f.useState(!1),y=f.useRef(null),h=f.useRef(null),m=f.useRef(!1);f.useEffect(()=>{m.current=u},[u]),f.useEffect(()=>{const x=document.createElement("style");return document.head.appendChild(x),y.current=x,()=>{var j;m.current&&((j=h.current)!=null&&j.fontMode)&&se(h.current.fontMode),y.current&&document.head.removeChild(y.current)}},[]);const g=Ze({control:l,name:"theme"});f.useEffect(()=>{if(h.current&&n){const x=!ne(g,h.current),j=g.fontMode!==h.current.fontMode;b(x||j)}},[g,n]);const k=f.useCallback(()=>{r&&(c("theme",r),h.current=r,r.fontMode&&se(r.fontMode)),d(!0),b(!1),X.checkWebUIFontExists().then(x=>{w(x)}).catch(x=>console.error("Failed to check custom font:",x))},[r,c]);f.useEffect(()=>{n&&g.fontMode&&se(g.fontMode)},[g.fontMode,n]);const N=i(async x=>{try{await F.setThemeConfig(x.theme),h.current=x.theme,x.theme.fontMode&&Ke(x.theme.fontMode),b(!1),v.success("保存成功"),Ye()}catch(j){const T=j.message;v.error(`保存失败: ${T}`)}}),L=async()=>{try{await a(),v.success("刷新成功")}catch(x){const j=x.message;v.error(`刷新失败: ${j}`)}};f.useEffect(()=>{k()},[r,k]),f.useEffect(()=>{if(g&&y.current){const x=Re(g);y.current.innerHTML=x}},[g]);const M=f.useMemo(()=>{var x;return(x=ae.find(j=>ne(j.theme,g)))==null?void 0:x.name},[g]),R=f.useMemo(()=>{var j;const x=h.current||r;return x?((j=ae.find(T=>ne(T.theme,x)))==null?void 0:j.name)||"自定义":null},[r,n,u]),E=f.useMemo(()=>{const x=h.current||r,j=(x==null?void 0:x.fontMode)||"aacute";return Vr[j]||j},[r,n,u]);return s?e.jsx(B,{loading:!0}):t?e.jsx("div",{className:"py-24 text-danger-500 text-center",children:t.message}):e.jsxs(e.Fragment,{children:[e.jsx("title",{children:"主题配置 - NapCat WebUI"}),e.jsx("div",{className:"w-full px-4 pt-4 pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("h1",{className:"text-xl font-bold text-default-900 tracking-tight",children:"外观设置"}),e.jsxs("div",{className:"flex items-center gap-3 text-tiny text-default-500",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(xe,{className:"text-primary",size:16}),e.jsx("span",{className:"font-medium text-default-700",children:R||"加载中..."})]}),e.jsx("div",{className:"w-px h-2.5 bg-default-300"}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(Ce,{className:"text-secondary",size:12}),e.jsx("span",{className:"font-medium text-default-700",children:E})]}),u&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-px h-2.5 bg-default-300"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-warning animate-pulse"}),e.jsx("span",{className:"text-warning font-semibold",children:"待保存"})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(S,{size:"sm",variant:"flat",color:"default",className:"font-medium bg-default-100 hover:bg-default-200 h-9",onPress:()=>{k(),v.success("已重置")},isDisabled:!u,children:"重置"}),e.jsx(S,{size:"sm",color:"primary",className:"font-medium shadow-lg shadow-primary/20 px-6 h-9",isLoading:o,onPress:()=>N(),isDisabled:!u,children:"保存应用"}),e.jsx("div",{className:"w-px h-6 bg-divider mx-1 hidden sm:block"}),e.jsx(S,{size:"sm",isIconOnly:!0,variant:"light",className:"text-default-500 hover:text-default-900 hidden sm:flex",onPress:L,children:e.jsx(Pe,{size:20})})]})]})}),e.jsx("div",{className:"px-4 pt-0 pb-4 w-full h-full",children:e.jsxs(Me,{"aria-label":"Theme Config Options",color:"primary",variant:"underlined",disableAnimation:!0,classNames:{tabList:"gap-8 w-full relative rounded-none p-0 border-b border-divider overflow-x-auto no-scrollbar",cursor:"w-full bg-primary h-[3px] -bottom-[1.5px]",tab:"max-w-fit px-0 h-12 hover:opacity-100 opacity-70 data-[selected=true]:opacity-100",tabContent:"font-semibold py-2",panel:"py-4"},children:[e.jsx(P,{title:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ce,{}),e.jsx("span",{children:"字体设置"})]}),children:e.jsx(q,{className:"shadow-sm border border-default-100 bg-background/60 backdrop-blur-md w-full",children:e.jsx(K,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col gap-6 w-full",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium mb-1",children:"WebUI 字体"}),e.jsx("p",{className:"text-sm text-default-500 mb-4",children:"自定义界面显示的字体风格"}),e.jsx(C,{control:l,name:"theme.fontMode",render:({field:x})=>e.jsxs(Fe,{label:"选择字体",variant:"bordered",selectedKeys:x.value?[x.value]:["aacute"],onChange:j=>x.onChange(j.target.value),className:"max-w-xs",disallowEmptySelection:!0,children:[e.jsx(D,{children:"Aa 偷吃可爱长大的"},"aacute"),e.jsx(D,{children:"系统默认"},"system"),e.jsx(D,{children:"自定义字体"},"custom")]})})]}),g.fontMode==="custom"&&e.jsxs("div",{className:"p-4 rounded-xl bg-default-50 border border-default-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"text-sm font-medium",children:"自定义字体文件"}),p&&e.jsx(Te,{size:"sm",color:"success",variant:"flat",startContent:e.jsx(Ue,{size:10}),children:"已上传"})]}),e.jsx($r,{label:"上传字体文件",placeholder:"拖拽或点击上传 (.woff/.woff2/.ttf/.otf)",accept:".ttf,.otf,.woff,.woff2",onChange:async x=>{try{if(p)try{await X.deleteWebUIFont()}catch(j){console.warn("Failed to delete existing font before upload:",j)}await X.uploadWebUIFont(x),v.success("上传成功，即将刷新页面"),setTimeout(()=>window.location.reload(),1e3)}catch(j){v.error("上传失败: "+j.message)}},onDelete:async()=>{try{await X.deleteWebUIFont(),v.success("删除成功，即将刷新页面"),setTimeout(()=>window.location.reload(),1e3)}catch(x){v.error("删除失败: "+x.message)}}}),e.jsx("p",{className:"text-xs text-default-400 mt-2",children:"注意：上传新字体会覆盖旧字体文件，更改后需要刷新页面生效。"})]})]})})})},"font"),e.jsx(P,{title:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(xe,{size:18}),e.jsx("span",{children:"选择主题"})]}),children:e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4",children:ae.map(x=>e.jsx(Qr,{theme:x,isSelected:M===x.name,onPreview:()=>{c("theme",{...x.theme,fontMode:g.fontMode})}},x.name))})},"theme"),e.jsx(P,{title:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(or,{}),e.jsx("span",{children:"自定义配色"})]}),children:e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:["light","dark"].map(x=>e.jsxs(q,{className:W("border shadow-sm",x==="dark"?"bg-[#18181b] border-zinc-800":"bg-white border-zinc-200"),children:[e.jsxs(Ie,{className:"pb-0 pt-4 px-4 flex-col items-start",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[x==="dark"?e.jsx(nr,{className:"text-zinc-400",size:20}):e.jsx(ir,{className:"text-orange-400",size:20}),e.jsx("h4",{className:W("font-bold text-large",x==="dark"?"text-white":"text-black"),children:x==="dark"?"深色模式":"浅色模式"})]}),e.jsxs("p",{className:W("text-tiny",x==="dark"?"text-zinc-400":"text-zinc-500"),children:["调整",x==="dark"?"深色":"浅色","主题下的颜色变量"]})]}),e.jsx(K,{className:"p-4",children:e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:Ge.map(j=>e.jsxs("div",{className:W("flex items-center gap-3 p-2 rounded-lg border transition-colors",x==="dark"?"bg-zinc-900/50 border-zinc-800 hover:bg-zinc-900":"bg-zinc-50 border-zinc-100 hover:bg-zinc-100"),children:[e.jsx(C,{control:l,name:`theme.${x}.${j}`,render:({field:{value:T,onChange:V}})=>{const O=(T==null?void 0:T.split(" "))??[0,0,0],Z=`hsl(${O[0]}, ${O[1]}, ${O[2]})`;return e.jsx(Or,{color:Z,onChange:ee=>{const H=ee.match(/hsl\((\d+(?:\.\d+)?),\s*(\d+(?:\.\d+)?)%,\s*(\d+(?:\.\d+)?)%\)/);H&&V(`${H[1]} ${H[2]}% ${H[3]}%`)}})}}),e.jsxs("div",{className:"flex flex-col overflow-hidden",children:[e.jsx("span",{className:W("text-xs font-medium truncate",x==="dark"?"text-zinc-300":"text-zinc-700"),children:j.replace("--heroui-","")}),e.jsx("span",{className:W("text-[10px] truncate",x==="dark"?"text-zinc-500":"text-zinc-400"),children:"Variable"})]})]},j))})})]},x))})},"custom-color")]})})]})},Le=({onChange:r,value:s,label:t})=>{const a=f.useRef(null);return e.jsxs("div",{className:"flex items-end gap-2",children:[e.jsx("div",{className:"w-5 h-5 flex-shrink-0",children:e.jsx(cr,{src:s,alt:t,className:"w-5 h-5 flex-shrink-0 rounded-none"})}),e.jsx(z,{ref:a,label:t,type:"file",placeholder:"选择图片",accept:"image/*",classNames:{inputWrapper:"bg-default-100/50 dark:bg-white/5 backdrop-blur-md border border-transparent hover:bg-default-200/50 dark:hover:bg-white/10 transition-all shadow-sm data-[hover=true]:border-default-300",input:"bg-transparent text-default-700 placeholder:text-default-400"},onChange:async l=>{var o;const i=(o=l.target.files)==null?void 0:o[0];if(i){const c=new FileReader;c.onload=async()=>{const n=c.result;r(n)},c.readAsDataURL(i)}}}),e.jsx(S,{onPress:()=>{r(""),a.current&&(a.current.value="")},color:"primary",variant:"flat",size:"sm",children:"删除"})]})};function ie(r){const s=r.replace(/-/g,"+").replace(/_/g,"/"),t=window.atob(s),a=new Uint8Array(t.length);for(let l=0;l<t.length;++l)a[l]=t.charCodeAt(l);return a}function le(r){return window.btoa(String.fromCharCode(...r)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}const qr=()=>{const{control:r,handleSubmit:s,formState:{isSubmitting:t},setValue:a}=_({defaultValues:{background:"",customIcons:{}}}),[l,i]=Y(A.backgroundImage,""),[o,c]=Y(A.customIcons,{}),[n,d]=f.useState(null),[u,b]=f.useState(!1),p=async()=>{b(!0);try{console.log("预先获取注册选项...");const h=await F.generatePasskeyRegistrationOptions();d(h),console.log("✅ 注册选项已获取并存储"),v.success("注册选项已准备就绪，请点击注册按钮")}catch(h){console.error("❌ 获取注册选项失败:",h),v.error("获取注册选项失败，请重试")}finally{b(!1)}},w=()=>{a("customIcons",o),a("background",l)},y=s(h=>{try{c(h.customIcons),i(h.background),v.success("保存成功")}catch(m){const g=m.message;v.error(`保存失败: ${g}`)}});return f.useEffect(()=>{w()},[o,l]),e.jsxs(e.Fragment,{children:[e.jsx("title",{children:"WebUI配置 - NapCat WebUI"}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("div",{className:"flex-shrink-0 w-full font-bold text-default-600 dark:text-default-400 px-1",children:"背景图"}),e.jsx(C,{control:r,name:"background",render:({field:h})=>e.jsx(Le,{...h})})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("div",{className:"flex-shrink-0 w-full font-bold text-default-600 dark:text-default-400 px-1",children:"自定义图标"}),tr.navItems.map(h=>e.jsx(C,{control:r,name:`customIcons.${h.label}`,render:({field:m})=>e.jsx(Le,{...m,label:h.label})},h.label))]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("div",{className:"flex-shrink-0 w-full font-bold text-default-600 dark:text-default-400 px-1",children:"Passkey认证"}),e.jsx("div",{className:"text-sm text-default-400 mb-2",children:"注册Passkey后，您可以更便捷地登录WebUI，无需每次输入token"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(S,{color:"secondary",variant:"flat",onPress:p,isLoading:u,className:"w-fit",children:[!u&&"📥","准备选项"]}),e.jsx(S,{color:"primary",variant:"flat",onPress:()=>{var h;if(!n){v.error('请先点击"准备选项"按钮获取注册选项');return}console.log("开始Passkey注册..."),console.log("使用预先获取的选项:",n),navigator.credentials.create({publicKey:{challenge:ie(n.challenge),rp:{name:n.rp.name,id:n.rp.id},user:{id:ie(n.user.id),name:n.user.name,displayName:n.user.displayName},pubKeyCredParams:n.pubKeyCredParams,timeout:3e4,excludeCredentials:((h=n.excludeCredentials)==null?void 0:h.map(m=>({id:ie(m.id),type:m.type,transports:m.transports})))||[],attestation:n.attestation}}).then(async m=>{var N,L;console.log("✅ 注册成功！凭据已创建"),console.log("凭据ID:",m.id),console.log("凭据类型:",m.type);const g=m,k={id:g.id,rawId:le(new Uint8Array(g.rawId)),response:{attestationObject:le(new Uint8Array(g.response.attestationObject)),clientDataJSON:le(new Uint8Array(g.response.clientDataJSON)),transports:((L=(N=g.response).getTransports)==null?void 0:L.call(N))||[]},type:g.type};console.log("准备验证响应:",k);try{if((await F.verifyPasskeyRegistration(k)).verified)v.success("Passkey注册成功！现在您可以使用Passkey自动登录"),d(null);else throw new Error("Passkey registration failed")}catch(M){console.error("❌ 验证失败:",M);const R=M;v.error(`Passkey验证失败: ${R.message}`)}}).catch(m=>{console.error("❌ 注册失败:",m);const g=m;console.error("错误名称:",g.name),console.error("错误信息:",g.message),g.name==="NotAllowedError"?v.error("Passkey注册被拒绝。请确保您允许了生物识别认证权限。"):g.name==="NotSupportedError"?v.error("您的浏览器不支持Passkey功能。"):g.name==="SecurityError"?v.error("安全错误：请确保使用HTTPS或localhost环境。"):v.error(`Passkey注册失败: ${g.message}`)})},disabled:!n,className:"w-fit",children:"🔐 注册Passkey"})]}),n&&e.jsx("div",{className:"text-xs text-green-600",children:"✅ 注册选项已准备就绪，可以开始注册"})]}),e.jsx(Q,{onSubmit:y,reset:w,isSubmitting:t})]})},Kr=async r=>{var t,a,l;const s=(t=r.target.files)==null?void 0:t[0];if(s){if(!s.name.endsWith(".zip")){v.error("请选择zip格式的配置文件");return}try{const i=new FormData;i.append("configFile",s);const o=await Ee("/OB11Config/ImportConfig",{method:"POST",body:i});if(!o.ok){const n=await o.json();throw new Error(n.message||"导入配置失败")}const c=await o.json();c.code===0?v.success(((a=c.data)==null?void 0:a.message)||"配置导入成功。"):v.error(`配置导入失败: ${((l=c.data)==null?void 0:l.message)||"未知错误"}`)}catch(i){const o=i.message;v.error(`导入配置失败: ${o}`)}finally{r.target.value=""}}},Yr=async()=>{var r,s;try{const t=await Ee("/OB11Config/ExportConfig",{method:"GET"});if(!t.ok)throw new Error("导出配置失败");const a=await t.blob(),l=window.URL.createObjectURL(a),i=document.createElement("a");i.href=l;const o=((s=(r=t.headers.get("Content-Disposition"))==null?void 0:r.split("=")[1])==null?void 0:s.replace(/"/g,""))||"config_backup.zip";i.download=o,document.body.appendChild(i),i.click(),window.URL.revokeObjectURL(l),document.body.removeChild(i),v.success("配置导出成功")}catch(t){const a=t.message;v.error(`导出配置失败: ${a}`)}},Gr=()=>e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"备份与恢复"}),e.jsx("p",{className:"text-sm text-default-500 mb-4",children:"您可以通过导入/导出配置文件来备份和恢复NapCat的所有设置"}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsx(S,{isIconOnly:!0,className:"bg-primary hover:bg-primary/90 text-white",radius:"full",onPress:Yr,title:"导出配置",children:e.jsx(hr,{size:20})}),e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("input",{type:"file",accept:".zip",onChange:Kr,className:"hidden"}),e.jsx(S,{isIconOnly:!0,className:"bg-primary hover:bg-primary/90 text-white",radius:"full",as:"span",title:"导入配置",children:e.jsx(fr,{size:20})})]})]}),e.jsx("div",{className:"mt-4 p-3 bg-warning/10 border border-warning/20 rounded-lg",children:e.jsx("div",{className:"flex items-start gap-2",children:e.jsx("p",{className:"text-sm text-warning",children:"导入配置会覆盖当前所有设置，请谨慎操作。导入前建议先导出当前配置作为备份。"})})})]})}),U=({children:r,size:s="md"})=>{const[t]=Y(A.backgroundImage,""),a=!!t;return e.jsx(q,{className:W("w-full mx-auto backdrop-blur-sm border border-white/40 dark:border-white/10 shadow-sm rounded-2xl transition-all",a?"bg-white/20 dark:bg-black/10":"bg-white/60 dark:bg-black/40",{"max-w-xl":s==="sm","max-w-3xl":s==="md","max-w-6xl":s==="lg"}),children:e.jsx(K,{className:"py-6 px-4 md:py-8 md:px-12",children:e.jsx("div",{className:"w-full flex flex-col gap-5",children:r})})})};function Mt(){const r=ze(),t=Xe({tab:"onebot"})[0].get("tab")??"onebot";return e.jsxs("section",{className:"w-full max-w-[1200px] mx-auto py-4 md:py-8 px-2 md:px-6 relative",children:[e.jsx("title",{children:"其它配置 - NapCat WebUI"}),e.jsxs(Me,{"aria-label":"config tab",fullWidth:!1,className:"w-full",selectedKey:t,onSelectionChange:a=>{r(`/config?tab=${a}`)},classNames:{base:"w-full flex-col items-center",tabList:"bg-white/40 dark:bg-black/20 backdrop-blur-md rounded-2xl p-1.5 shadow-sm border border-white/20 dark:border-white/5 mb-4 md:mb-8 w-full md:w-fit mx-auto overflow-x-auto hide-scrollbar",cursor:"bg-white/80 dark:bg-white/10 backdrop-blur-md shadow-sm rounded-xl",tab:"h-9 px-4 md:px-6",tabContent:"text-default-600 dark:text-default-300 font-medium group-data-[selected=true]:text-primary",panel:"w-full relative p-0"},children:[e.jsx(P,{title:"OneBot配置",children:e.jsx(U,{children:e.jsx(Er,{})})},"onebot"),e.jsx(P,{title:"服务器配置",children:e.jsx(U,{children:e.jsx(Pr,{})})},"server"),e.jsx(P,{title:"SSL配置",children:e.jsx(U,{size:"sm",children:e.jsx(Fr,{})})},"ssl"),e.jsx(P,{title:"WebUI配置",children:e.jsx(U,{children:e.jsx(qr,{})})},"webui"),e.jsx(P,{title:"登录配置",children:e.jsx(U,{children:e.jsx(Rr,{})})},"login"),e.jsx(P,{title:"修改密码",children:e.jsx(U,{size:"sm",children:e.jsx(zr,{})})},"token"),e.jsx(P,{title:"主题配置",children:e.jsx(U,{size:"lg",children:e.jsx(Xr,{})})},"theme"),e.jsx(P,{title:"备份与恢复",children:e.jsx(U,{children:e.jsx(Gr,{})})},"backup")]})]})}export{Mt as default};
